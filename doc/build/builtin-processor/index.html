<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>内置 Processor | EDP</title>
    <link rel="stylesheet" href="/edp/css/page.css" type="text/css">
    <link rel="stylesheet" href="/edp/css/font-awesome.css" type="text/css">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?9773c6955c8a4722f2938db42b6d6c04";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
</head>
<body>
<header id="header">
    <a class='logo' href="/edp/">
        <img src="/edp/css/images/logo.png" width="120" alt="logo">
    </a>

    <nav class="menu">
        <a href="/edp/doc/initialization/install/"><i class="fa fa-book"></i> Docs</a>
        <a href="https://github.com/ecomfe/edp" target="_blank"><i class="fa fa-github"></i> GitHub</a>
    </nav>
</header>

<div class="wrap">
    <aside id="sidebar">
<div class="tree">
    <h1>Category</h1>
    <ul class="category">
        <li><b class="cat-title">安装与使用</b>
            <ul>
                <li><a href="/edp/doc/initialization/install/">安装</a>
                    <ul>
                        <li><a href="/edp/doc/initialization/install/#npm install">npm install</a></li>
                        <li><a href="/edp/doc/initialization/install/#使用cnpm安装">使用cnpm安装</a></li>
                        <li><a href="/edp/doc/initialization/install/#使用内网npm镜像安装">使用内网npm镜像安装</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/initialization/use-cli/">通过命令行使用</a></li>
                <li><a href="/edp/doc/initialization/use-web/">通过web使用</a></li>
                <li><a href="/edp/doc/initialization/update/">升级</a></li>
            </ul>
        </li>
        <li><b class="cat-title">包管理</b>
            <ul>
                <li><a href="/edp/doc/package-management/reasonof-pack-mngm/">为什么要进行包管理</a></li>
                <li><a href="/edp/doc/package-management/find-curr-pack/">查找当前存在的包</a></li>
                <li><a href="/edp/doc/package-management/instl-and-use/">导入并使用包</a>
                    <ul>
                        <li><a href="/edp/doc/package-management/instl-and-use/#导入包的最新版">导入包的最新版</a></li>
                        <li><a href="/edp/doc/package-management/instl-and-use/#导入指定版本的包">导入指定版本的包</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/package-management/update-pack/">升级已导入的包</a>
                    <ul>
                        <li><a href="/edp/doc/package-management/update-pack/#升级指定包">升级指定包</a></li>
                        <li><a href="/edp/doc/package-management/update-pack/#升级所有包">升级所有包</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><b class="cat-title">项目管理</b>
            <ul>
                <li><a href="/edp/doc/project-management/init-proj/">初始化项目</a></li>
                <li><a href="/edp/doc/project-management/advantage/">使用edp项目的好处</a></li>
            </ul>
        </li>
        <li><b class="cat-title">项目构建</b>
            <ul>
                <li><a href="/edp/doc/build/build/">构建一个项目</a>
                    <ul>
                        <li><a href="/edp/doc/build/build/#指定输出目录">指定输出目录</a></li>
                        <li><a href="/edp/doc/build/build/#强制覆盖">强制覆盖</a></li>
                        <li><a href="/edp/doc/build/build/#指定构建配置文件">指定构建配置文件</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/build/build-proc/">构建过程</a></li>
                <li><a href="/edp/doc/build/builtin-processor/">内置 Processor</a>
                    <ul>
                        <li><a href="/edp/doc/build/builtin-processor/#公共属性">公共属性</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#LessCompiler">LessCompiler</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#StylusCompiler">StylusCompiler</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#CssCompressor">CssCompressor</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#JsCompressor">JsCompressor</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#ModuleCompiler">ModuleCompiler</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#PathMapper">PathMapper</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#TplMerge">TplMerge</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#AddCopyright">AddCopyright</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#VariableSubstitution">VariableSubstitution</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#MD5Renamer">MD5Renamer</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#OutputCleaner">OutputCleaner</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#BabelProcessor">BabelProcessor</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#BcsUploader">BcsUploader</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#CssSpriter">CssSpriter</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#HtmlMinifier">HtmlMinifier</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#Html2JsCompiler">Html2JsCompiler</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#ReplaceDebug">ReplaceDebug</a></li>
                        <li><a href="/edp/doc/build/builtin-processor/#StringReplace">StringReplace</a></li>
                        
                    </ul>
                </li>
                <li><a href="/edp/doc/build/cust-processor/">自定义 Processor</a>
                    <ul>
                        <li><a href="/edp/doc/build/cust-processor/#Processor的运行过程">Processor的运行过程</a></li>
                        <li><a href="/edp/doc/build/cust-processor/#通过Object自定义processor">通过Object自定义processor</a></li>
                        <li><a href="/edp/doc/build/cust-processor/#从AbstractProcessor继承自定义processor">从AbstractProcessor继承自定义processor</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/build/cust-build/">通过配置进行自定义构建</a>
                    <ul>
                        <li><a href="/edp/doc/build/cust-build/#input">input</a></li>
                        <li><a href="/edp/doc/build/cust-build/#output">output</a></li>
                        <li><a href="/edp/doc/build/cust-build/#exclude">exclude</a></li>
                        <li><a href="/edp/doc/build/cust-build/#fileEncodings">fileEncodings</a></li>
                        <li><a href="/edp/doc/build/cust-build/#getProcessors">getProcessors</a></li>
                        <li><a href="/edp/doc/build/cust-build/#injectProcessor">injectProcessor</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><b class="cat-title">前端代码静态检测</b>
            <ul>
                <li><a href="/edp/doc/lint/code-check/">代码检测</a></li>
                <li><a href="/edp/doc/lint/js-check/">Javascript代码检测</a>
                    <ul>
                        <li><a href="/edp/doc/lint/js-check/#自定义配置">自定义jshint配置</a></li>
                        <li><a href="/edp/doc/lint/js-check/#排除检测文件">排除检测文件</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/lint/css-check/">CSS代码检测</a>
                    <ul>
                        <li><a href="/edp/doc/lint/css-check/#自定义配置">自定义csslint配置</a></li>
                        <li><a href="/edp/doc/lint/css-check/#排除检测文件">排除检测文件</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/lint/html-check/">HTML代码检测</a>
                    <ul>
                        <li><a href="/edp/doc/lint/html-check/#排除检测文件">排除检测文件</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><b class="cat-title">使用WebServer进行调试</b>
            <ul>
                <li><a href="/edp/doc/webserver/start-server/">启动WebServer</a>
                    <ul>
                        <li><a href="/edp/doc/webserver/start-server/#指定监听端口">指定监听端口</a></li>
                        <li><a href="/edp/doc/webserver/start-server/#指定WebServer配置文件">指定WebServer配置文件</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/webserver/conf-server/">配置WebServer</a>
                    <ul>
                        <li><a href="/edp/doc/webserver/conf-server/#port">port</a></li>
                        <li><a href="/edp/doc/webserver/conf-server/#directoryIndexes">directoryIndexes</a></li>
                        <li><a href="/edp/doc/webserver/conf-server/#documentRoot">documentRoot</a></li>
                        <li><a href="/edp/doc/webserver/conf-server/#injectResource">injectResource</a></li>
                        <li><a href="/edp/doc/webserver/conf-server/#getLocations">getLocations</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/webserver/resource-func/">资源处理函数</a></li>
                <li><a href="/edp/doc/webserver/inner-resour-func/">内置资源处理函数</a>
                    <ul>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#file">file</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#content">content</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#header">header</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#json">json</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#jsonp">jsonp</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#dumpRequest">dumpRequest</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#redirect">redirect</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#less">less</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#autoless">autoless</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#stylus">stylus</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#autostylus">autostylus</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#autocss">autocss</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#coffee">coffee</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#autocoffee">autocoffee</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#php">php</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#proxy">proxy</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#proxyNoneExists">proxyNoneExists</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#html2js">html2js</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#livereload">livereload</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#listDirectory">listDirectory</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#addRequestHeader">addRequestHeader</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#write">write</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#home">home</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#delay">delay</a></li>
                        <li><a href="/edp/doc/webserver/inner-resour-func/#empty">empty</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/webserver/cust-resour-func/">自定义资源处理函数</a></li>
            </ul>
        </li>
        <li><b class="cat-title">扩展自己的EDP命令</b>
            <ul>
                <li><a href="/edp/doc/command-extension/builtin-comd/">Builtin Commands</a></li>
                <li><a href="/edp/doc/command-extension/comd-resol/">Command Resolve</a>
                    <ul>
                        <li><a href="/edp/doc/command-extension/comd-resol/#Default Command">Default Command</a></li>
                        <li><a href="/edp/doc/command-extension/comd-resol/#Sub Command">Sub Command</a></li>
                        <li><a href="/edp/doc/command-extension/comd-resol/#Arguments and Options">Arguments and Options</a></li>
                    </ul>
                </li>
                <li><a href="/edp/doc/command-extension/user-comd/">User Commands</a></li>
                <li><a href="/edp/doc/command-extension/comd-help/">Command Help</a></li>
            </ul>
        </li>
        <li><b class="cat-title">诊断工具</b>
            <ul>
                <li><a href="/edp/doc/doctor/doctor/">Doctor</a></li>
            </ul>
        </li>
    </ul>
</div>
</aside>
<script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
<script>
/*
    $(function() {
        $(".category a").on("click", function() {
            var $this = $(this);
            var $li = $this.parents("li:eq(0)");
            var $ul = $li.children("ul:eq(0)");

            if($($ul)[0].className){
                $ul.removeClass();
                $this.removeClass('open');
            }
            else{
                $ul.addClass("show");
                $this.addClass('open');
            }
            var str = "";
            $(".category.show").each(function(){
                str += $("ul").index($(this)[0]) + " ";
            });
            localStorage.setItem("show_index", str);
        });

        var str = localStorage.getItem("show_index");
        str = str.substring(0, str.length - 1);
        var arr = str.split(" ");
        for(var i = 0; i < arr.length; i++) {
            $("ul:eq(" + arr[i] + ")").addClass("show");
        }

        $(".category.show").siblings("a").addClass('open');

    });
*/

//    var aa = document.getElementsByTagName('a');
////    alert(lis.length);
////    e.stopPropagation();
//
//    for(var i = 0; i < aa.length; i++){
//        if(document.all){
//            aa[i].attachEvent('onclick', toggleList);
//        }
//        else{
//            aa[i].addEventListener('click', toggleList, false);
//        }
//    }
//    function toggleList(e){
//        var e = e || window.event;
//        var childList = e.srcElement.parentElement.getElementsByTagName('ul');
////        alert(childList.length);
//        if(childList.length > 0) {
////            alert(childList[0].className);
//            if(childList[0].className) {
//                childList[0].removeAttribute('class');
//            }
//            else {
//                childList[0].setAttribute('class', 'show');
//            }
//        }
//
////        alert(typeof(e.srcElement.parentElement) );
//    }
</script>
    <section id="main">
        <article>
    <h1 class="article-title">内置 Processor</h1>

    <p>EDP很重要的一个功能就是通过<code>edp build</code>来构建项目。在<a href="Build#%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B">构建过程</a>中，<code>处理</code>阶段，对资源的处理主要由一个或多个Processor完成。Processor直接是链式的串行处理过程，每个Processor处理的是上一个Processor处理后的结果。</p>
<h2 id="公共属性">公共属性</h2><h3 id="files属性">files属性</h3><p>该属性从 <strong>1.0.0版本</strong> 开始引入。</p>
<p>通过<code>Processor</code>的<code>files</code>参数可以为<code>Processor</code>选择需要处理的文件。每个<code>Processor</code>都支持<code>files</code>，其是一个<code>Array</code>，其中每一项是一个符合glob规则的<code>pattern string</code>。后续的各个<code>Processor</code>介绍将不再对<code>files</code>参数进行说明。</p>
<p>每个<code>Processor</code>在开始处理前，其要处理的文件是一个<code>空集</code>，我们称作<code>PROCESS_FILES</code>。通过<code>files</code>的每一项<code>pattern</code> <strong>按顺序</strong> 选择文件。</p>
<ul>
<li>如果<code>pattern</code>不以<code>!</code>开头，从<code>BUILD_FILES</code>中选出符合该<code>pattern</code>的文件放入<code>PROCESS_FILES</code></li>
<li>如果<code>pattern</code>以<code>!</code>开头，从<code>PROCESS_FILES</code>中将符合该<code>pattern</code>的文件排除</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> LessCompiler(&#123;</span><br><span class="line">    files: [</span><br><span class="line">        <span class="string">'*.less'</span>,</span><br><span class="line">        <span class="string">'!test/**/*.less'</span></span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="LessCompiler">LessCompiler</h2><p>编译<code>less</code>文件，并对其他文件中<code>less</code>资源的引用替换成<code>css</code>。具体有：</p>
<ol>
<li>*.less编译为*.css</li>
<li>entryFiles指定入口文件，把<code>&lt;link href=&quot;*.less&quot;&gt;</code>替换为<code>&lt;link href=&quot;*.css&quot;&gt;</code></li>
<li>*.js中通过插件引用*.less的地方修改为*.css</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new LessCompiler(&#123;&#10;    files: [ &#39;*.less&#39; ],&#10;    /* entryExtnames: &#39;html,php,tpl&#39; &#26087;&#29256;&#26412;&#20351;&#29992; &#26032;&#29256;&#26412;&#31181;&#20860;&#23481;&#20294;&#19981;&#25512;&#33616; &#25512;&#33616;&#20351;&#29992;entryFiles*/&#10;    entryFiles: [&#10;        &#39;*.html&#39;, &#39;*.htm&#39;, &#39;*.phtml&#39;,&#10;        &#39;*.tpl&#39;, &#39;*.vm&#39;, &#39;*.js&#39;&#10;    ]&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>下面是<code>LessCompiler</code>的参数说明：</p>
<h3 id="compileOptions">compileOptions</h3><p><code>Object</code>。less编译参数，默认值为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    paths: [ less file&#39;s directory ],&#10;    relativeUrls: true&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>如果想要输出的css是压缩之后的，可以添加参数<code>{ compress: true }</code>即可，一定程度上可以代替<code>CssCompressor</code>的功能.</p>
<h3 id="entryFiles">entryFiles</h3><p><code>Array.&lt;string&gt;</code>，less入口文件选择，规则与<code>files</code>相同。 <strong>默认值</strong> 是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[ </span><br><span class="line">    <span class="string">'*.html'</span>, </span><br><span class="line">    <span class="string">'*.htm'</span>, </span><br><span class="line">    <span class="string">'*.phtml'</span>,</span><br><span class="line">    <span class="string">'*.tpl'</span>,</span><br><span class="line">    <span class="string">'*.vm'</span>,</span><br><span class="line">    <span class="string">'*.js'</span> </span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>被匹配上的文件被称为less入口文件。<code>LessCompiler</code>将自动扫描里面对<code>less</code>资源的引用，替换成<code>css</code>。</p>
<h3 id="files">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是<code>[ &#39;*.less&#39; ]</code></p>
<h3 id="less">less</h3><p><code>Object</code>，自定义的<code>less</code>模块。</p>
<p><code>edp-build</code>有自己依赖的<code>less</code>版本，如果不想使用该版本，可以自己提供一个<code>less</code>模块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new LessCompiler(&#123;&#10;  less: require( &#34;./tools/less&#34; )&#10;&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="StylusCompiler">StylusCompiler</h2><p>StylusCompiler的功能跟LessCompiler类似。编译<code>styl</code>文件，并对其他文件中<code>styl</code>资源的引用替换成<code>css</code>。</p>
<ol>
<li>*.styl编译为*.css</li>
<li>entryFiles指定入口文件，把<code>&lt;link href=&quot;*.styl&quot;&gt;</code>替换为<code>&lt;link href=&quot;*.css&quot;&gt;</code></li>
<li>*.js中通过插件引用*.styl的地方修改为*.css</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new StylusCompiler(&#123;&#10;    files: [ &#39;*.styl&#39; ],&#10;     /* entryExtnames: &#39;html,php,tpl&#39; &#26087;&#29256;&#26412;&#20351;&#29992; &#26032;&#29256;&#26412;&#31181;&#20860;&#23481;&#20294;&#19981;&#25512;&#33616; &#25512;&#33616;&#20351;&#29992;entryFiles */&#10;    entryFiles: [&#10;        &#39;*.html&#39;, &#39;*.htm&#39;, &#39;*.phtml&#39;,&#10;        &#39;*.tpl&#39;, &#39;*.vm&#39;, &#39;*.js&#39;&#10;    ]&#10;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>下面是<code>StylusCompiler</code>的参数说明：</p>
<h3 id="compileOptions-1">compileOptions</h3><p><code>Object</code>，stylus编译参数，默认值为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    paths: [ stylus file&#39;s directory ],&#10;    pathname: &#39;stylus file&#39;s fullpath&#39;,&#10;    use: this.compileOptions&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>如果想要输出的css是压缩之后的，可以添加参数<code>{ compress: true }</code>即可，一定程度上可以代替<code>CssCompressor</code>的功能.</p>
<h3 id="entryFiles-1">entryFiles</h3><p>请参考<code>LessCompiler</code>的<code>entryFiles</code>参数说明。</p>
<h3 id="files-1">files</h3><p>请参考<code>LessCompiler</code>的<code>files</code>参数说明。</p>
<h3 id="stylus">stylus</h3><p><code>Object</code>，自定义的<code>stylus</code>模块。</p>
<p><code>edp-build</code>有自己依赖的<code>stylus</code>版本，如果不想使用该版本，可以自己提供一个<code>stylus</code>模块。使用方式参考<code>LessCompiler</code>。</p>
<h2 id="CssCompressor">CssCompressor</h2><p>对<code>css</code>资源进行压缩。<code>edp-build</code>使用的css压缩工具是<code>clean-css</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new CssCompressor(&#123;&#10;    files: [ &#39;*.css&#39;, &#39;*.less&#39; ]&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>下面是<code>CssCompressor</code>的参数说明：</p>
<h3 id="compressOptions">compressOptions</h3><p><code>Object</code>，<code>clean-css</code>的压缩参数，默认值为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    &#34;noAdvanced&#34;: true,  // clean-css&#30340;&#20248;&#21270;&#27169;&#24335;&#26576;&#20123;&#24773;&#20917;&#19979;&#23384;&#22312;&#38382;&#39064;&#65292;&#40664;&#35748;&#31105;&#29992;&#10;    &#34;keepBreaks&#34;: true,  // &#19981;&#21387;&#32553;&#25104;&#19968;&#34892;&#10;    &#34;relativeTo&#34;: css file&#39;s directory&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>如果想了解<code>clean-css</code>还支持哪些参数，可以查看<a href="https://github.com/GoalSmashers/clean-css#how-to-use-clean-css-programmatically" target="_blank" rel="external">clean-css的参数说明</a>。</p>
<h3 id="files-2">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是<code>[ &#39;*.css&#39; ]</code>。</p>
<h2 id="JsCompressor">JsCompressor</h2><p>对<code>js</code>资源进行压缩。<code>edp-build</code>使用的js压缩工具是<code>uglifyjs2</code>。默认只处理<code>*.js</code>文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new JsCompressor(&#123;&#10;    files: [ &#39;*.js&#39;, &#39;*.coffee&#39; ]&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>下面是<code>JsCompressor</code>的参数说明：</p>
<h3 id="files-3">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是<code>[ &#39;*.js&#39;, &#39;!*.min.js&#39; ]</code>。</p>
<h3 id="compressOptions-1">compressOptions</h3><p><code>Object</code>，压缩选项，默认值是：<code>{ &quot;warnings&quot;: false, &quot;conditionals&quot;: false }</code>。详细信息请参考<a href="http://lisperator.net/uglifyjs/compress" target="_blank" rel="external">uglifyjs2 compress options</a></p>
<h3 id="mangleOptions">mangleOptions</h3><p><code>Object</code>，默认值是：<code>{ &quot;except&quot;: [ &#39;require&#39;, &#39;exports&#39;, &#39;module&#39; ] }</code>，也就是给变量重命名的时候，忽略这三个变量名。</p>
<h3 id="sourceMapOptions">sourceMapOptions</h3><p><code>Object</code>，生成 <a href="http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/" target="_blank" rel="external">JavaScript Source Map</a> 文件，默认值是: <code>{ enable: false, root: &#39;sourcemap&#39;, host: null }</code> <code>enable</code>: 表示功能是否开启, <code>root</code>: 决定了 output 目录中的source map所在的目录, <code>host</code>: 决定了 sourceMappingURL 的前缀</p>
<h2 id="ModuleCompiler">ModuleCompiler</h2><p>编译AMD模块。主要是将匿名模块具名化，并根据配置和依赖进行模块合并。默认只处理<code>*.js</code>。</p>
<p><code>ModuleCompiler</code>的处理需要一个模块配置文件，该模块配置文件必须是一个JSON文件，详情请参见<code>configFile</code>配置项说明。</p>
<p>注意：如果最终发布的代码不需要对代码进行合并，那么就没有必要将匿名模块具名化，因此也无需使用<code>ModuleCompiler</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new ModuleCompiler(&#123;&#10;    configFile: &#39;my-module.conf&#39;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<p>下面是<code>ModuleCompiler</code>的参数说明：</p>
<h3 id="files-4">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是<code>[ &#39;*.js&#39; ]</code>。</p>
<h3 id="configFile">configFile</h3><p>模块配置文件，默认为<code>module.conf</code>。配置文件是一个<code>JSON</code>文件，允许包含以下属性：</p>
<ul>
<li><code>{string}``baseUrl</code> - 模块查找的根路径，相对于配置文件所在目录。</li>
<li><code>{Object}``paths</code> - 特殊模块查找路径，相对于<code>baseUrl</code></li>
<li><code>{Array.&lt;Object&gt;}``packages</code> - 包引入配置，其中每个包配置<code>location</code>项的路径相对于<code>baseUrl</code></li>
<li><code>{Object}``combine</code> - 需要合并的模块，其中key为模块id，value为<code>{boolean}</code>或<code>Object</code>。</li>
</ul>
<p><code>baseUrl</code>、<code>paths</code>、<code>packages</code>配置项为AMD标准配置项，详细说明请参考<a href="https://github.com/amdjs/amdjs-api/blob/master/CommonConfig.md" target="_blank" rel="external">AMD Common Config</a>或<a href="https://github.com/ecomfe/esl/blob/master/doc/config.md" target="_blank" rel="external">ESL的配置文档</a></p>
<h3 id="getCombineConfig">getCombineConfig</h3><p><code>function(Object=):Object</code>，接收一个<code>Object</code>，返回值是<code>Object</code>类型。ModuleCompiler在读取<strong>合并模块配置项</strong>的时候，主要参考两个地方：</p>
<ol>
<li><code>module.conf</code>文件中的<code>combine</code>字段</li>
<li><code>getCombineConfig</code>函数的返回值</li>
</ol>
<p>当我们发现配置了<code>getCombineConfig</code>之后，就会调用这个函数，传递的参数是<code>module.conf</code>中<code>combine</code>字段的值。</p>
<hr>
<h3 id="常见模块合并场景的配置方法">常见模块合并场景的配置方法</h3><p>当我们想要合并一些文件的时候，是以Module Id的维度来声明的。例如，当我们想要合并<code>src/common/main.js</code>中的代码，那么可以简单的在<code>module.conf</code>中配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    &#34;combine&#34;: &#123;&#10;        &#34;common/main&#34;: true&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>合并的过程是递归处理的，也就是先找到<code>common/main</code>的一级依赖，把这些依赖的代码合并进来，然后再找二级依赖，三级依赖等等，最终把<code>common/main</code>所有的依赖都合并进来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">....&#10;....&#10;&#10;define( &#34;common/main&#34;, function( require ) &#123;&#10;    ...&#10;    ...&#10;&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p>当我们在合并的过程中想要排除一些模块的时候，可以使用<code>modules</code>，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    &#34;combine&#34;: &#123;&#10;        &#34;common/main&#34;: &#123;&#10;            &#34;modules&#34;: [ &#34;!~er&#34; ]&#10;        &#125;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>也就是虽然<code>common/main</code>最终可能依赖了<code>er</code>的代码，但是不要合并进来，而是需要的时候再去按需加载。</p>
<hr>
<p>当我们在合并的过程中想要显式的加入一些模块的时候，可以使用<code>modules</code>，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    &#34;combine&#34;: &#123;&#10;        &#34;common/main&#34;: &#123;&#10;            &#34;modules&#34;: [ &#34;~esui&#34; ]&#10;        &#125;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>也就是虽然<code>common/main</code>没有直接依赖<code>esui</code>的代码，但是在将来的某个时刻可能会用到，那么就先合并进来，这样子后续使用的时候就不需要重新去加载了。</p>
<h2 id="PathMapper">PathMapper</h2><p>对最终输出的文件路径进行一些改动。主要是基于如下两个方面的考虑：</p>
<ol>
<li>项目中源码主要放在<code>src</code>目录，如果我们最终输出的代码里面还是保留<code>src</code>目录，就看起来很不正式</li>
<li>对最终输出的路径进行一些改动，可以一定程度上降低因为浏览器或者CDN缓存导致没有获取最新资源的问题</li>
</ol>
<p>PathMapper一般做为最后一个Processor。</p>
<p>下面是<code>PathMapper</code>的参数说明：</p>
<h3 id="from">from</h3><p><code>string</code>，<strong>默认值</strong>是<code>src</code>，用来设置替换的源路径，一般都是配置成：<code>{ &quot;from&quot;: &quot;src&quot; }</code>。</p>
<h3 id="to">to</h3><p><code>string</code>，<strong>默认值</strong>是<code>asset</code>，用来设置替换的目标路径，一般都是配置成：<code>{ &quot;to&quot;: &quot;asset&quot; }</code>。</p>
<p>有时候，我们希望多版本并存，以前的版本能够被保留，可以配置成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// SvnRevision&#20989;&#25968;&#35831;&#33258;&#24049;&#23454;&#29616;&#10;&#123; &#10;    &#34;to&#34;: &#34;asset-&#34; + SvnRevision()&#10;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="mapper">mapper</h3><p><code>function(string):string</code>，路径映射函数。可以理解为是加强版的from和to，如果单纯的配置<code>from</code>和<code>to</code>无法满足需求的话，可以配置mapper。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> PathMapper(&#123;</span><br><span class="line">    mapper: <span class="function"><span class="keyword">function</span>(<span class="params"> value </span>) </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> value.replace( from, to ) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="replacements">replacements</h3><p><code>Array.&lt;Object&gt;</code>，用于指定路径替换后相应资源的引用替换，比如将<code>html</code>中的<code>img</code>标签里<code>src</code>属性为<code>src/img</code>的替换成<code>asset/img</code>。replacements的默认值如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replacements: [&#10;    &#123; type: &#39;html&#39;, tag: &#39;link&#39;, attribute: &#39;href&#39;, extnames: pageEntries &#125;,&#10;    &#123; type: &#39;html&#39;, tag: &#39;img&#39;, attribute: &#39;src&#39;, extnames: pageEntries &#125;,&#10;    &#123; type: &#39;html&#39;, tag: &#39;script&#39;, attribute: &#39;src&#39;, extnames: pageEntries &#125;,&#10;    &#123; extnames: &#39;html&#39;, replacer: &#39;module-config&#39; &#125;,&#10;    &#123; extnames: &#39;less,css&#39;, replacer: &#39;css&#39; &#125;&#10;]</span><br></pre></td></tr></table></figure>
<p>前面三条规则应该可以猜出是什么意思，这里就不解释了；第四条规则指的是替换*.html中<code>require.config</code>的配置，比如把：<code>{ &quot;baseUrl&quot;: &quot;src&quot; }</code>替换为<code>{ &quot;baseUrl&quot;: &quot;asset&quot; }</code>；第五条规则是替换所有css文件中引用图片的路径。</p>
<p>替换的时候只是替换相对路径的引用，如果路径是远程的资源，比如<code>http://</code>, <code>https://</code>, <code>//</code>就不会处理，也不应该处理。</p>
<h2 id="TplMerge">TplMerge</h2><p>这个Processor的作用是合并项目中出现过的模板资源，这样子在发布状态下就会尽可能的减少模板的请求。</p>
<p>下面是<code>TplMerge</code>的参数说明：</p>
<h3 id="files-5">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是<code>[ &#39;src/**/*.js&#39; ]</code>。</p>
<h3 id="pluginIds">pluginIds</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是<code>[ &#39;tpl&#39;, &#39;er/tpl&#39; ]</code>，数组中的每一项都是一个模板插件的Id，如果你的项目中模板插件的Id没有被包含在里面，那么就需要配置这个参数。</p>
<h3 id="configFile-1">configFile</h3><p><code>string</code>，<strong>默认值</strong>是<code>module.conf</code>。详细请参考<code>ModuleCompiler</code>的<code>configFile</code>。</p>
<h3 id="outputType">outputType</h3><p><code>string</code>，如果想要把合并之后的模板输出为一个AMD的模块，那么请把这个参数的值设置为<code>js</code>，设置其它的值是不接受的。</p>
<h3 id="outputPluginId">outputPluginId</h3><p><code>string</code>。</p>
<p>如果合并之后，如果想要把合并之后的模板输出为一个AMD的模块，那么请把这个参数值设置为一个模板插件的Id，例如<code>jstpl</code>。因为使用<code>xhr</code>的方式加载模板的插件跟使用<code>require</code>的方式来加载模板的插件应该是不一样的，所以需要单独设置一下这个参数的值。</p>
<p>注意：<code>outputPluginId</code>必须同时设置才会有效，否则没有效果。</p>
<p>如果我们把最终合并的模板输出为一个AMD的模块，那么就可以把模板也部署到Cookieless Domain下面了，不再受限于xhr的跨域问题的限制。</p>
<p>注意：如果需要输出为AMD的模块，那么主要的工作是由<code>html2js</code>这个npm package来完成的，因此TplMerge在一定程度上完成了Html2JsCompiler的工作。</p>
<h2 id="AddCopyright">AddCopyright</h2><p>给最终输出的文件头部添加一个版权声明。</p>
<p>默认给<code>css</code>、<code>less</code>、<code>js</code>文件添加版权声明。即<code>files</code>的默认值为<code>[&#39;*.css&#39;, &#39;*.less&#39;, &#39;*.js&#39;]</code>。</p>
<p>如果在<code>构建配置文件</code>（通常为<code>edp-build-config.js</code>）同级目录下存在<code>copyright.txt</code>文件，则版权声明以该文件内容为准。否则将使用默认的版权声明信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;/*! &#39; + new Date().getFullYear() + &#39; Baidu Inc. All Rights Reserved */\n&#39;</span><br></pre></td></tr></table></figure>
<h2 id="VariableSubstitution">VariableSubstitution</h2><p>将文本文件里<code>{edp-variable:{variableName}}</code>相应部分替换成相应<code>variableName</code>的值。通常用于为页面的资源引用附加版本号。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> VariableSubstitution(&#123;</span><br><span class="line">    files: [<span class="string">'*.html'</span>],</span><br><span class="line">    variables: &#123;</span><br><span class="line">        version: <span class="string">'1.0.0'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line">html里：</span><br><span class="line">&lt;link rel="stylesheet" href="main.css?&#123;edp-variable:&#123;version&#125;&#125;"&gt;</span><br><span class="line">会被替换成：</span><br><span class="line">&lt;link rel="stylesheet" href="main.css?1.0.0"&gt;</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
<p>下面是<code>VariableSubstitution</code>的参数说明：</p>
<h3 id="variables">variables</h3><p><code>Object</code>，用于声明各个变量的值。</p>
<h2 id="MD5Renamer">MD5Renamer</h2><p>将静态文件根据<code>MD5</code>摘要命名，并且替换html和css中对该资源的引用地址。</p>
<p>以<code>MD5</code>命名通常有利于浏览器缓存，甚至可以在HTTP头声明该资源永久缓存。<code>MD5Renamer</code>将生成一个内容完全相同，名称为<code>MD5</code>摘要的文件。原文件将保留，不做删除。</p>
<p><code>MD5Renamer</code>通常放在Processor链的倒数第二的位置，<code>PathMapper</code>前。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> MD5Renamer( &#123;</span><br><span class="line">    files: [ </span><br><span class="line">        <span class="string">"src/common/css/main.less"</span></span><br><span class="line">    ],</span><br><span class="line">    replacements: &#123;</span><br><span class="line">        html: [</span><br><span class="line">            <span class="string">"index.html"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125; )</span><br></pre></td></tr></table></figure>
<p>下面是<code>MD5Renamer</code>的参数说明：</p>
<h3 id="replacements-1">replacements</h3><p><code>Object</code>，要替换的资源配置。该对象只支持<code>html</code>和<code>css</code>两个属性，分别是<code>Array.&lt;string&gt;</code>。</p>
<p>不同类型的资源，将进行不同的替换：</p>
<ul>
<li>对于<code>html</code>，替换script的src、img的src、link的href</li>
<li>对于<code>css</code>，只替换url()</li>
</ul>
<p>对非<code>files</code>中匹配的资源的引用，将不做替换。上面的例子中，只有对main.less的引用会被替换，ui.less的引用不会被替换。</p>
<h2 id="OutputCleaner">OutputCleaner</h2><p>如果观察最终输出的<code>output</code>目录中的文件，你可能会发现可能存在一些完全用不到的文件，例如<code>*.less</code>，<code>*.styl</code>，如果你想进一步优化的输出的内容，可以使用这个Processor来删除一些明确不需要的文件。</p>
<p>下面是<code>OutputCleaner</code>的参数说明：</p>
<h3 id="files-6">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是：<code>[ &#39;*.less&#39;, &#39;*.styl&#39;, &#39;*.ts&#39;, &#39;*.coffee&#39; ]</code></p>
<h2 id="BabelProcessor">BabelProcessor</h2><p>此处理器的作用是使用转译器 <em><a href="https://babeljs.io" target="_blank" rel="external">babel</a></em> 将项目使用ES6语法的js代码转为ES5代码。</p>
<p>下面是<code>BabelProcessor</code>的参数说明：</p>
<h3 id="files-7">files</h3><p><code>Array.&lt;string&gt;</code>，<strong>默认值</strong>是：<code>[ &#39;*.es6&#39;, &#39;*.es&#39; ]</code></p>
<h3 id="compileOptions-2">compileOptions</h3><p><code>Object, babel</code> 的参数，默认值是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    loose: &#39;all&#39;,&#10;    modules: &#39;amd&#39;,&#10;    compact: false,&#10;    ast: false,&#10;    blacklist: [&#39;strict&#39;]&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>详细信息请参考<a href="https://babeljs.io/docs/usage/options/#options" target="_blank" rel="external">Options for babel transpiling.</a></p>
<h2 id="BcsUploader">BcsUploader</h2><p>可以使用这个处理器将文件上传到 bcs(百度云存储) 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new BcsUploader(&#123;&#10;    ak: &#39;ak&#39;,&#10;    sk: &#39;sk&#39;,&#10;    bucket: &#39;weigou-baidu-com&#39;,&#10;    prefix: &#39;bcj-static/20140624&#39;,&#10;    concurrent: 5,&#10;    files: [&#10;    ]&#10;&#125;)</span><br></pre></td></tr></table></figure>
<p>下面是<code>BcsUploader</code>的参数说明：</p>
<h3 id="files-8">files</h3><p><code>Array.&lt;string&gt;</code> 处理器要处理的文件 <strong>默认值</strong>是：<code>[&#39;*.js&#39;, &#39;*.css&#39;, &#39;*.less&#39;]</code></p>
<h3 id="ak">ak</h3><p><code>string</code> AccessKey bcs提供的</p>
<h3 id="sk">sk</h3><p><code>string</code> SecretKey bcs提供的</p>
<h3 id="bucket">bucket</h3><p><code>string</code> bcs提供的bucket</p>
<h3 id="prefix">prefix</h3><p><code>string</code> 上传文件的路径的前缀</p>
<h3 id="concurrent">concurrent</h3><p><code>number</code> 上传并发数，<strong>默认值</strong>是：5</p>
<h3 id="maxSize">maxSize</h3><p><code>number</code> 文件最大尺寸 <strong>默认值</strong>是：10 <em> 1024 </em> 1024</p>
<h2 id="CssSpriter">CssSpriter</h2><p>通过<a href="https://github.com/quyatong/CssSpriter" target="_blank" rel="external">css-spriter</a>工具分析css文件中引用的图片文件构建成雪碧图，然后自动修改css文件中的图片引用信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new CssSpriter(&#123;&#10;    files: [&#10;    ]&#10;&#125;)</span><br></pre></td></tr></table></figure>
<p>下面是<code>CssSpriter</code>的参数说明：</p>
<h3 id="files-9">files</h3><p><code>Array.&lt;string&gt;</code> 处理器要处理的文件 <strong>默认值</strong>是：<code>[]</code></p>
<h2 id="HtmlMinifier">HtmlMinifier</h2><p>此处理器默认通过使用<a href="https://github.com/kangax/html-minifier" target="_blank" rel="external">html-minifier</a>工具分析html文档的内容，对html文档进行压缩，有效的减小项目内html文档的体积</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new HtmlMinifier(&#123;&#10;    files: [],&#10;    minifyOptions: &#123;&#125;&#10;&#125;)</span><br></pre></td></tr></table></figure>
<p>下面是<code>HtmlMinifier</code>的参数说明:</p>
<h3 id="files-10">files</h3><p><code>Array.&lt;string&gt;</code> 处理器要处理的文件 <strong>默认值</strong>是：<code>[&#39;*.html&#39;, &#39;*.tpl.html&#39;]</code></p>
<h3 id="minifyOptions">minifyOptions</h3><p><code>Object, html-minifier</code> 的参数，默认值是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;    ignoreCustomComments: [&#10;        /^\s*(\/)?([a-z]+)\s*(?::([\s\S]*))?$/&#10;    ]&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> 更多配置参数请参考：<a href="https://github.com/kangax/html-minifier" target="_blank" rel="external">html-minifier</a></p>
<h2 id="Html2JsCompiler">Html2JsCompiler</h2><p>将html文档转换成js文档，在js中引用时可以解决跨域的问题</p>
<p>下面是<code>Html2JsCompiler</code>的参数说明:</p>
<h3 id="files-11">files</h3><p><code>Array.&lt;string&gt;</code> 处理器要处理的文件 <strong>默认值</strong>是：<code>null</code></p>
<h3 id="extnames">extnames</h3><p>使用文件后缀名配置要处理的文件，与参数<code>files</code>功能相同，<strong>默认值</strong>是：<code>[&#39;hjs&#39;, &#39;mustcahe&#39;]</code> </p>
<p><strong>需要注意的是</strong>：如果没有配置<code>files</code>和<code>extnames</code>处理器会自动使用<code>extnames</code>的默认值作为要处理的文件，当配置了<code>files</code>时处理器会忽略<code>extnames</code>的配置</p>
<h3 id="clean">clean</h3><p><code>boolean</code> <strong>默认值</strong>是：<code>false</code> 配置为true将只发出一条警告，<a href="https://github.com/junmer/html2js" target="_blank" rel="external">html2js</a>不去处理文件</p>
<h3 id="wrap">wrap</h3><p><code>string</code> 表示转换后js代码的包装器类型 <strong>默认值</strong>是：<code>amd</code> </p>
<p>可选值：<code>null，amd，commonjs</code> 分别表示无包装，amd包装，CommonJS包装</p>
<p>各参数具体效果请参考:<a href="https://github.com/junmer/html2js" target="_blank" rel="external">html2js</a></p>
<h3 id="mode">mode</h3><p><code>string</code> 表示html转换成js代码后的代码样式 <strong>默认值</strong>是：<code>null</code> </p>
<p>可选值：</p>
<p><code>null 或者 default</code>:表示保持原html文档的格式</p>
<p><code>compress</code>:清除原文档中每行开始和结束位置两端的空白以及转义字符</p>
<p><code>format</code>:整理成符合<a href="https://github.com/ecomfe/spec/blob/master/javascript-style-guide.md#建议-使用-数组-或--拼接字符串" target="_blank" rel="external">规范</a>的js代码</p>
<p>各参数具体效果请参考:<a href="https://github.com/junmer/html2js" target="_blank" rel="external">html2js</a></p>
<h2 id="ReplaceDebug">ReplaceDebug</h2><p>修正DEBUG变量，将window.DEBUG的值改为false</p>
<p>下面是<code>ReplaceDebug</code>的参数说明:</p>
<h3 id="files-12">files</h3><p><code>Array.&lt;string&gt;</code> 处理器要处理的文件 <strong>默认值</strong>是：<code>null</code></p>
<h3 id="extnames-1">extnames</h3><p>使用文件后缀名配置要处理的文件，与参数<code>files</code>功能相同，<strong>默认值</strong>是：<code>[&#39;html&#39;]</code> </p>
<p><strong>需要注意的是</strong>：如果没有配置<code>files</code>和<code>extnames</code>处理器会自动使用<code>extnames</code>的默认值作为要处理的文件，当配置了<code>files</code>时处理器会忽略<code>extnames</code>的配置</p>
<h2 id="StringReplace">StringReplace</h2><p>此处理器用于字符串替换</p>
<p>下面是<code>StringReplace</code>的参数说明:</p>
<h3 id="files-13">files</h3><p><code>Array.&lt;string&gt;</code> 处理器要处理的文件 <strong>默认值</strong>是：<code>null</code></p>
<h3 id="replacements-2">replacements</h3><p><code>Array.&lt;Object&gt;</code>，用于指定要匹配的字符信息，以及要被替换成的字符串或者返回字符串的函数如下示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#10;    &#123;&#10;        from: &#39;foo&#39;,&#10;        to: &#39;bar&#39;&#10;    &#125;,&#10;    &#123;&#10;       from: /(\w+)\s*, \s*(\w+)/,&#10;       to: function(word, first, second)&#123;&#10;           return &#39;&#39; + second + first;&#10;       &#125;&#10;    &#125;&#10;]</span><br></pre></td></tr></table></figure>

</article>

<nav class="article-pagination">
    
    <a href="/edp/doc/build/build-proc/" class="article-prev">前一篇: 构建过程</a>
    
    
    <a href="/edp/doc/build/cust-processor/" class="article-next">后一篇: 自定义 Processor</a>
    
</nav>

<div class="ds-thread" data-thread-key="doc/build/builtin-processor/" data-title="内置 Processor" data-url="http://ecomfe.github.io/edp/doc/build/builtin-processor/"></div>
<script>
var duoshuoQuery = {short_name:"edp"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>

    
    </section>
</div>

<footer>
    <p class="cp">©2015 <a href="http://efe.baidu.com/" target="_blank">Baidu EFE</a> | Powered By <a href="http://hexo.io/">Hexo</a></p>
</footer>


</body>
</html>